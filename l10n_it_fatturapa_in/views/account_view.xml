<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>

        <record model="ir.ui.view" id="view_fatturapa_in_attachment_form">
            <field name="name">fatturapa.attachment.in.form</field>
            <field name="model">fatturapa.attachment.in</field>
            <field name="arch" type="xml">
                <form string="Import FatturaPA" version="7.0">
                    <div>
                        <group>
                            <field name="name"/>
                            <field name="datas_fname"/>
                            <field name="datas" filename="datas_fname" />
                        </group>
                        <separator string="Invoices"></separator>
                        <field name="in_invoice_ids"></field>
                        <group groups="base.group_no_one" string="History">
                            <label for="create_uid" string="Creation"/>
                            <div name="creation_div">
                                <field name="create_uid" readonly="1" class="oe_inline"/> on
                                <field name="create_date" readonly="1" class="oe_inline"/>
                            </div>
                        </group>
                    </div>
                    <div class="oe_chatter">
                        <field name="message_follower_ids" widget="mail_followers"/>
                        <field name="message_ids" widget="mail_thread"/>
                    </div>
                </form>
            </field>
        </record>

        <record model="ir.ui.view" id="view_fatturapa_in_attachment_tree">
            <field name="name">fatturapa.attachment.in.tree</field>
            <field name="model">fatturapa.attachment.in</field>
            <field name="arch" type="xml">
                <tree string="Xml Attachment">
                    <field name="name"/>
                    <field name="create_date" />
                </tree>
            </field>
        </record>


        <record id="action_fattura_pa_in" model="ir.actions.act_window">
            <field name="name">Incoming fatturaPA files</field>
            <field name="res_model">fatturapa.attachment.in</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="view_fatturapa_in_attachment_tree"/>
        </record>

        <menuitem action="action_fattura_pa_in" id="menu_fattura_pa_in_tree" parent="document.menu_document_doc"/>

        <!-- Extend purchase invoice  -->
        <record model="ir.ui.view" id="view_invoice_form_fatturapa_in">
            <field name="name">account.invoice.fatturapa_in</field>
            <field name="model">account.invoice</field>
            <field name="inherit_id" ref="l10n_it_withholding_tax.invoice_supplier_form"/>
            <field name="arch" type="xml">
                <field name="partner_id" position="after">
                    <field name="tax_representative_id"  readonly="1"/>
                    <field name="intermediary"  readonly="1"/>
                </field>
                <field name="date_invoice" position="before">
                    <field name="sender"  readonly="1"/>
                    <field name="doc_type"  readonly="1"/>
                </field>
                <field name="has_withholding" position="before">
                    <field name="ftpa_withholding_type" attrs="{'invisible': [('has_withholding', '=', False)]}"  readonly="1"/>
                    <field name="ftpa_withholding_rate" attrs="{'invisible': [('has_withholding', '=', False)]}"  readonly="1"/>
                    <field name="ftpa_withholding_payment_reason" attrs="{'invisible': [('has_withholding', '=', False)]}"  readonly="1"/>
                </field>
                <field name="comment" position="before">
                    <field name="sender"  readonly="1"/>
                    <field name="doc_type"  readonly="1"/>
                </field>
                <field name="tax_line" position="after">
                    <field name="discount_rise_price_ids" nolabel="1" readonly="1" >
                        <tree editable="bottom" string="Rise Price Discount">
                            <field name="name"/>
                            <field name="percentage"/>
                            <field name="amount" />
                        </tree>
                    </field>
                    <field name="activity_progress_ids" nolabel="1" readonly="1" >
                        <tree editable="bottom" string="Progress Work">
                            <field name="fatturapa_activity_progress"/>
                        </tree>
                    </field>
                </field>
                <field name="residual" position="after">
                    <field name="virtual_stamp"  readonly="1" />
                    <field name="stamp_amount"   readonly="1"/>
                </field>
                <field name="payment_ids"   position="before">
                    <separator string="FatturaPA Payment"/>
                        <group>
                            <field name="fatturapa_payments" nolabel="1" >
                                <tree string="Related Documents">
                                    <field name="payment_terms" />
                                </tree>
                                <form string="Related Documents" version="7.0">
                                    <sheet>
                                        <group>
                                            <field name="payment_terms" />
                                        </group>
                                        <group string="Payments Details">
                                            <field name="payment_methods" nolabel="1" >
                                            <tree editable="bottom" string="Payments">
                                                    <field name="recipient"/>
                                                    <field name="fatturapa_pm_id"/>
                                                    <field name="payment_term_start" />
                                                    <field name="payment_days"/>
                                                    <field name="payment_due_date"/>
                                                    <field name="payment_amount"/>
                                                    <field name="post_office_code"/>
                                                    <field name="payment_bank_name"/>
                                                    <field name="prepayment_discount"/>
                                                    <field name="max_payment_date"/>
                                                    <field name="penalty_amount"/>
                                                    <field name="penalty_date"/>
                                                    <field name="payment_code"/>
                                                    <field name="account_move_line_id"/>
                                                    <field name="payment_data_id" invisible="1"/>
                                                </tree>
                                            </field>
                                        </group>
                                    </sheet>
                                </form>
                            </field>
                        </group>
                </field>
                <xpath expr="//notebook" position="inside">
                    <page string="Related Documents ">
                            <group string="Related Documents">
                                <field name="related_documents" nolabel="1" readonly="1">
                                <tree editable="bottom" string="Related Documents">
                                        <field name="type"/>
                                        <field name="name"/>
                                        <field name="lineRef" readonly="1"/>
                                        <field name="date"/>
                                        <field name="numitem"/>
                                        <field name="code"/>
                                        <field name="cig"/>
                                        <field name="cup"/>
                                    </tree>
                                </field>
                            </group>
                    </page>
                    <page string="Welfare Fund">
                            <group string="Welfare Fund">
                                <field name="welfare_fund_ids" nolabel="1" readonly="1">
                                <tree editable="bottom" string="Welfare Fund Details">
                                        <field name="name"/>
                                        <field name="fund_fiscalpos"/>
                                        <field name="welfare_rate_tax" readonly="1"/>
                                        <field name="welfare_amount_tax"/>
                                        <field name="welfare_Iva_tax"/>
                                        <field name="welfare_taxable"/>
                                        <field name="subjected_withholding"/>
                                        <field name="pa_line_code"/>
                                    </tree>
                                </field>
                            </group>
                    </page>
                    <page string="Delivery">
                        <group>
                            <group string="Delivery"  >
                                <field name="carrier_id" readonly="1"/>
                                <field name="transport_vaicle" readonly="1"/>
                                <field name="description" readonly="1"/>
                                <field name="pickup_datetime" readonly="1"/>
                                <field name="transport_date" readonly="1"/>
                                 <field name="delivery_datetime" readonly="1" />
                            </group>
                            <group >
                                <field name="unit_weight"  readonly="1"/>
                                <field name="gross_weight" readonly="1"/>
                                <field name="net_weight" readonly="1"/>
                                <field name="number_items" readonly="1"/>
                                <field name="incoterm" widget="selection" readonly="1"/>
                            </group>
                        </group>
                        <group>
                             <field name="delivery_address" readonly="1" />
                        </group>
                    </page>
                    <page string="FatturaPA">
                        <group>
                            <group string="Results">
                                <field name="fatturapa_attachment_in_id" readonly="1" />
                            </group>
                        </group>
                    </page>
                    <page string="FatturaPA attachments">
                        <group string="Attachments">
                            <field name="fatturapa_doc_attachments" nolabel="1" readonly="1" />
                        </group>
                    </page>
                </xpath>
            </field>
        </record>

    </data>
</openerp>

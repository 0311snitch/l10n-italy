<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>

        <!-- View used in the wizard -->
        <record id="view_move_line_form" model="ir.ui.view">
            <field name="name">account.move.line.form.inherit</field>
            <field name="model">account.move.line</field>
            <field name="type">form</field>
            <field name="inherit_id" ref="account.view_move_line_form"/>
            <field name="arch" type="xml">
                <field name="reconcile_partial_id" position="after">
                    <field name="amount_to_pay"/>
                </field>
            </field>
        </record>

        <record model="ir.ui.view" id="view_move_line_tree_wiz">
            <field name="name">account.move.line.tree</field>
            <field name="model">account.move.line</field>
            <field name="type">tree</field>
            <field name="priority" eval="1"/>
            <field name="arch" type="xml">
                <tree string="RiBa Entry Line">
                    <field name="partner_id"/>
                    <field name="ref"/>
                    <field name="name"/>
                    <field name="journal_id"/>
                    <field name="account_id"/>
                    <field name="date_maturity"/>
                    <field name="date"/>
                    <field name="debit" sum="Total debit"/>
                    <field name="credit" sum="Total credit"/>
                    <field name="amount_to_pay"/>
                    <field name="amount_currency"/>
                    <field name="currency_id"/>
                    <field name="period_id" invisible="1"/>
                </tree>
            </field>
        </record>

        <menuitem name="RiBa" parent="account.menu_finance" id="menu_riba" icon="terp-folder-green" sequence="8"/>

        <record id="view_riba_mode_search" model="ir.ui.view">
            <field name="name">riba.mode.search</field>
            <field name="model">riba.mode</field>
            <field name="type">search</field>
            <field name="arch" type="xml">
                <form string="Riba Mode">
                    <field name="name"/>
                    <field name="journal" widget='selection'/>
                    <field name="company_id" widget='selection' groups="base.group_multi_company"/>
                    <newline/>
                    <group expand="0" string="Group By...">
                      <filter string="Journal" icon="terp-folder-orange" domain="[]" context="{'group_by':'journal'}"/>
                    </group>
                </form>
            </field>
        </record>

        <record id="view_riba_mode_tree" model="ir.ui.view">
            <field name="name">riba.mode.tree</field>
            <field name="model">riba.mode</field>
            <field name="type">tree</field>
            <field name="arch" type="xml">
                <tree string="Riba Mode">
                    <field name="name"/>
                    <field name="journal"/>
                    <field name="company_id" groups="base.group_multi_company"/>
                </tree>
            </field>
        </record>

        <record id="view_riba_mode_form" model="ir.ui.view">
            <field name="name">riba.mode.form</field>
            <field name="model">riba.mode</field>
            <field name="type">form</field>
            <field name="arch" type="xml">
                <form string="Riba Mode">
                    <field name="name" select="1"/>
                    <field name="journal" select="1"/>
                    <field name="bank_id" domain="[('partner_id','=',partner_id)]"  />
                    <field name="company_id" select="1" widget='selection' groups="base.group_multi_company" on_change="onchange_company_id(company_id)"/>
                    <field name="partner_id" select="1" widget='selection' invisible="1"/>
                </form>
            </field>
        </record>
       <record id="action_riba_mode_form" model="ir.actions.act_window">
            <field name="name">Riba Mode</field>
            <field name="res_model">riba.mode</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="search_view_id" ref="view_riba_mode_search"/>
        </record>

        <menuitem action="action_riba_mode_form" id="menu_action_riba_mode_form" parent="account.menu_configuration_misc"/> -->

<record id="view_riba_order_form" model="ir.ui.view">
            <field name="name">riba.order.form</field>
            <field name="model">riba.order</field>
            <field name="type">form</field>
            <field name="arch" type="xml">
                <form string="Riba Order">
                    <group col="6" colspan="4">
                      <field name="reference"/>

                      <field name="mode" widget='selection'/>
                      <button colspan="2" name="%(action_riba_order_create)d" string="Select Riba to Issue" type="action" attrs="{'invisible':[('state','=','done')]}" icon="gtk-find"/>
                      <field name="company_id" widget='selection' groups="base.group_multi_company"/> 
                    </group>
                    <field name="line_ids" colspan="4" widget="one2many_list" nolabel="1" default_get="{'order_id': active_id or False}" >
                        <form string="Riba Line">
                            <notebook>
                                <page string="Riba">
                                    <field name="move_line_id" on_change="onchange_move_line(move_line_id,parent.mode,parent.date_prefered,parent.date_scheduled,currency,company_currency)" select="1" domain="[('debit', '>',0),('amount_to_pay','>',0)] "/>
                                    <separator colspan="4" string="Transaction Information"/>
                                    <field name="date"/>
                                    <group colspan="2">
                                        <field name="amount_currency" on_change="onchange_amount(amount_currency,currency,company_currency)"/>
                                        <field name="currency" nolabel="1"/>
                                    </group>
                                    <field name="partner_id" on_change="onchange_partner(partner_id,parent.mode)" select="1"/>
                                    <field domain="[('partner_id','=',partner_id)]" name="bank_id"/>
                                    <separator colspan="2" string="Owner Account"/>
                                    <separator colspan="2" string="Destination Account"/>
                                    <field colspan="2" name="info_owner" nolabel="1"/>
                                    <field colspan="2" name="info_partner" nolabel="1"/>
                                    <field colspan="4" name="communication"/>
                                    <field colspan="4" name="communication2"/>
                                    <field name="name"/>
                                    <field name="state"/>
                                    <field name="company_id" widget='selection' groups="base.group_multi_company"/> 
                                </page>
                                <page string="Information">

                                    <separator colspan="4" string="General Information"/>
                                    <group colspan="2">
                                        <field name="amount"/>
                                        <field name="company_currency" nolabel="1"/>
                                    </group>
                                    <separator colspan="4" string="Entry Information"/>
                                    <field name="create_date" readonly="1"/>
                                    <field name="ml_maturity_date"/>
                                    <field name="ml_inv_ref"/>
                                </page>
                            </notebook>
                        </form>
                        <tree string="riba Line">
                            <field name="ml_inv_ref" />
                            <field name="partner_id" select="1"/>
                            <field name="bank_id" domain="[('partner_id', '=', partner_id)]"/>
                            <field name="ml_maturity_date"/>
                            <field name="date"/>
                            <field name="amount_currency" string="Amount"/>
                            <field name="currency"/>
                            <field name="name"/>
                            <field name="amount" sum="Total in Company Currency" invisible="1"/>
                        </tree>
                    </field>
                    <field name="date_created"/>
                    <field name="date_done"/>
                    <field name="state" readonly="1" select="1"/>
                    <group col="4" colspan="2">
                         <button name="cancel" states="draft,open" string="Cancel" icon="gtk-cancel"/>
                         <button name="open" states="draft" string="Confirm Issue"  icon="gtk-apply"/>
                         <button name="set_done" states="open" string="Make Issue" type="object" icon="gtk-execute"/>
                         <button name="set_to_draft" states="cancel" string="Set to draft" type="object" icon="gtk-convert"/>
                    </group>
                </form>
            </field>
        </record> -->

        <record id="view_riba_order_tree" model="ir.ui.view">
            <field name="name">riba.order.tree</field>
            <field name="model">riba.order</field>
            <field name="type">tree</field>
            <field eval="4" name="priority"/>
            <field name="arch" type="xml">
                <tree colors="blue:state in ('draft');gray:state in ('cancel','done');black:state in ('open')" string="riba order">
                    <field name="reference"/>
                    <field name="mode"/>
                    <field name="user_id"/>
                    <field name="company_id" groups="base.group_multi_company"/>
                    <field name="date_created"/>
                    <field name="date_done"/>
                    <field name="total"/>
                    <field name="state"/>
                    <button name="cancel" states="draft,open" string="Cancel" icon="gtk-cancel"/>
                    <button name="open" states="draft" string="Confirm Issue"  icon="gtk-apply"/>
                    <button name="set_done" states="open" string="Make Issue"  type ="object" icon="gtk-execute"/>
                </tree>
            </field>
        </record>

        <record id="view_riba_order_search" model="ir.ui.view">
            <field name="name">riba.order.tree.search</field>
            <field name="model">riba.order</field>
            <field name="type">search</field>
            <field name="arch" type="xml">
                <search string="Search">
                    <group col="8" colspan="4">
                        <filter string="Draft" domain="[('state','=','draft')]" icon="terp-document-new"/>
                        <filter string="Confirmed" domain="[('state','=','open')]" icon="terp-camera_test"/>
                        <filter string="Done" domain="[('state','=','done')]" icon="terp-dialog-close"/>
                        <separator orientation="vertical"/>
                        <field name="reference"/>
                        <field name="mode" widget='selection'/>
                        <field name="date_done"/>
                        <field name="state"/>
                    </group>
                    <newline/>
                    <group expand="0" string="Group By...">
                        <filter string="Riba Mode" context="{'group_by': 'mode'}" icon="terp-dolar"/>
                        <filter string="State" context="{'group_by': 'state'}" icon="terp-stock_effects-object-colorize"/>
                    </group>
                </search>
            </field>
        </record>

        <record id="action_riba_order_tree" model="ir.actions.act_window">
            <field name="name">RiBa Order</field>
            <field name="res_model">riba.order</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="search_view_id" ref="view_riba_order_search"/>
            <field name="help">A riba order is a issue request from your company to pay a custumer invoice or a customer debit note. Here you can register all riba orders that should be done, keep track of all riba orders and mention the invoice reference and the partner the riba should be done for.</field>
        </record>

        <menuitem name="RiBa Issue" action="action_riba_order_tree" id="menu_action_riba_order_form" parent="menu_riba" sequence="3"/>

        <record id="action_riba_order_tree_new" model="ir.actions.act_window">
            <field name="name">New riba Order</field>
            <field name="res_model">riba.order</field>
            <field name="view_type">form</field>
            <field name="view_mode">form,tree</field>
        </record>

        <record id="view_riba_line_form" model="ir.ui.view">
            <field name="name">riba Line</field>
            <field name="model">riba.line</field>
            <field name="type">form</field>
            <field name="arch" type="xml">
                <form string="Riba Line">
                    <notebook>
                        <page string="riba">
                            <field name="order_id" select="1"/>
                            <field name="move_line_id" on_change="onchange_move_line(move_line_id, False, currency, company_currency)" select="1" domain="[('debit', '>',0),('amount_to_pay','>',0)] "/>
                            <separator colspan="4" string="Transaction Information"/>
                            <field name="date"/>
                            <group colspan="2">
                                <field name="amount_currency" on_change="onchange_amount(amount_currency,currency,comapny_currency)"/>
                                <field name="currency" nolabel="1"/>
                            </group>
                            <field name="partner_id" on_change="onchange_partner(partner_id, False)" select="1"/>
                            <field domain="[('partner_id','=',partner_id)]" name="bank_id"/>
                            <separator colspan="2" string="Owner Account"/>
                            <separator colspan="2" string="Desitination Account"/>
                            <field colspan="2" name="info_owner" nolabel="1"/>
                            <field colspan="2" name="info_partner" nolabel="1"/>

                            <field colspan="4" name="communication"/>
                            <field colspan="4" name="communication2"/>
                            <field name="name"/>
                             <field name="state"/>
                        </page>
                        <page string="Information">
                            <separator colspan="4" string="General Information"/>
                            <group colspan="2">
                                <field name="amount" select="1"/>
                                <field name="company_currency" nolabel="1"/>
                            </group>
                            <separator colspan="4" string="Entry Information"/>
                            <field name="create_date"/>
                            <field name="ml_maturity_date"/>
                            <field name="ml_inv_ref"/>
                        </page>
                    </notebook>
                </form>
            </field>
        </record>
        <record id="view_riba_line_tree" model="ir.ui.view">
            <field name="name">riba Lines</field>
            <field name="model">riba.line</field>
            <field name="type">tree</field>
            <field eval="4" name="priority"/>
            <field name="arch" type="xml">
                <tree string="Riba Line">
                    <field name="order_id"/>
                    <field name="ml_inv_ref" />
                    <field name="ml_maturity_date"/>
                    <field name="partner_id" select="1"/>
                    <field name="amount" sum="Amount Total"/>
                    <field name="amount_currency" sum="Currency Amount Total"/>
                    <field name="currency"/>
                    <field name="bank_id" domain="[('partner_id', '=', partner_id)]"/>
                    <field name="move_line_id" on_change="onchange_move_line(move_line_id,parent.mode)"/>
                    <field name="create_date"/>
                    <field name="name"/>
                </tree>
            </field>
        </record>
        <record id="action_riba_line_form" model="ir.actions.act_window">
            <field name="name">riba Line</field>
            <field name="res_model">riba.line</field>
            <field name="view_type">tree</field>
            <field name="view_mode">form,tree</field>
        </record>

     <record id="riba_bank_statement_form" model="ir.ui.view">
            <field name="name">account.bank.statement.form.inherit</field>
            <field name="model">account.bank.statement</field>
            <field name="type">form</field>
            <field name="inherit_id" ref="account.view_bank_statement_form"/>
            <field name="arch" type="xml">
                <field name="journal_id" position="after">
                    <button name="%(action_riba_issue_populate_statement_confirm)d" attrs="{'invisible':[('state','=','confirm')]}" string="Import Riba Lines" type="action" icon="gtk-execute"/>
                </field>
            </field>
        </record>

        <act_window domain="[('move_line_id.move_id.id', '=', move_id)]" id="act_account_invoice_2_riba_line" name="Riba Lines" res_model="riba.line" src_model="account.invoice"/> -->

              

    </data>
</openerp>
